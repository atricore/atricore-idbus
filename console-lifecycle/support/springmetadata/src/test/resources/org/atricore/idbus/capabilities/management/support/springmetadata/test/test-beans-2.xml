<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:ns2="http://www.springframework.org/schema/osgi"
       xsi:schemaLocation="
      http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
      http://www.springframework.org/schema/osgi  http://www.springframework.org/schema/osgi/spring-osgi.xsd"
      >

    <bean name="idbus1-mediation-unit" class="org.atricore.idbus.kernel.main.mediation.SpringMediationUnitImpl">
        <property name="name">
            <value>idbus1-mediation-unit</value>
        </property>
    </bean>
    <bean name="idbus1-cot" class="org.atricore.idbus.kernel.main.federation.metadata.CircleOfTrustImpl">
        <property name="name">
            <value>idbus1-cot</value>
        </property>
    </bean>
    <bean name="idbus1-cot-manager" class="org.atricore.idbus.capabilities.sso.main.SamlR2CircleOfTrustManager">
        <property name="cot">
            <ref bean="idbus1-cot"/>
        </property>
    </bean>
    <bean name="idbus1-session-manager" class="org.atricore.idbus.kernel.main.session.service.SSOSessionManagerImpl">
        <property name="maxInactiveInterval">
            <value>30</value>
        </property>
        <property name="maxSessionsPerUser">
            <value>-1</value>
        </property>
        <property name="invalidateExceedingSessions">
            <value>false</value>
        </property>
        <property name="sessionMonitorInterval">
            <value>10000</value>
        </property>
        <property name="sessionIdGenerator">
            <bean name="idbus1-session-id-generator"
                  class="org.atricore.idbus.kernel.main.session.service.SessionIdGeneratorImpl">
                <property name="algorithm">
                    <value>MD5</value>
                </property>
            </bean>
        </property>
        <property name="sessionStore">
            <bean name="idbus1-session-store" class="org.atricore.idbus.idojos.memorysessionstore.MemorySessionStore"/>
        </property>
    </bean>
    <bean name="idbus1-aqm" class="org.atricore.idbus.kernel.main.mediation.MessageQueueManager">
        <property name="jmsProviderDestinationName">
            <value>Queue/IDBUS/idbus1/Artifact</value>
        </property>
        <property name="artifactGenerator">
            <bean name="idbus1-aqm-artifact-generator"
                  class="org.atricore.idbus.kernel.main.mediation.ArtifactGeneratorImpl"/>
        </property>
        <property name="connectionFactory">
            <ref bean="idbus1-aqm-connection-factory"/>
        </property>
    </bean>
    <bean name="idbus1-aqm-connection-factory" class="org.apache.activemq.ActiveMQConnectionFactory">
        <property name="brokerURL">
            <value>tcp://localhost:61217</value>
        </property>
    </bean>
    <bean name="idbus1-aqm-broker" class="org.apache.activemq.xbean.XBeanBrokerService">
        <property name="transportConnectors">
            <list>
                <bean name="idbus1-aqm-broker-transport-connector"
                      class="org.apache.activemq.broker.TransportConnector"/>
            </list>
        </property>
    </bean>
    <ns2:service ref="idbus1-mediation-unit" interface="org.atricore.idbus.kernel.main.mediation.IdentityMediationUnit"
                 id="idbus1-mediation-unit-exporter"/>
    <ns2:reference timeout="60" cardinality="1..1"
                   interface="org.atricore.idbus.kernel.main.mediation.IdentityMediationUnitContainer"
                   id="identity-mediation-engine"/>
    <ns2:reference timeout="60" cardinality="1..1" interface="org.atricore.idbus.kernel.planning.jbpm.BPMSManager"
                   id="bpms-manager"/>
</beans>
