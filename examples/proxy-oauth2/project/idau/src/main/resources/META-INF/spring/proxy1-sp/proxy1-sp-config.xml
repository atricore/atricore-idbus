<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:ns2="http://www.springframework.org/schema/osgi" xmlns:ns3="http://www.springframework.org/schema/tool" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd http://www.springframework.org/schema/osgi http://www.springframework.org/schema/osgi/spring-osgi.xsd">
    <description>proxy1-sp : SP Configuration generated by Atricore Identity Bus Server on 1 Feb 2012 18:41:24 GMT </description>
    <bean class="org.atricore.idbus.kernel.main.mediation.provider.ServiceProviderImpl" name="proxy1-sp">
        <property name="name">
            <value>proxy1-sp</value>
        </property>
        <property name="role">
            <value>{urn:oasis:names:tc:SAML:2.0:metadata}SPSSODescriptor</value>
        </property>
        <property name="unitContainer">
            <ref bean="ida3-container"/>
        </property>
        <property name="cotManager">
            <ref bean="ida3-cot-manager"/>
        </property>
        <property name="stateManager">
            <ref bean="ida3-state-manager"/>
        </property>
        <property name="defaultFederationService">
            <ref bean="proxy1-sp-sso-default-svc"/>
        </property>
        <property name="bindingChannel">
            <ref bean="proxy1-sp-idp1"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.sp.SSOSPMediator" name="proxy1-sp-samlr2-mediator">
        <property name="preferredIdpAlias">
            <value>http://localhost:8082/IDBUS/IDA1/IDP1/SAML2/MD</value>
        </property>
        <property name="preferredIdpSSOBinding">
            <value>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact</value>
        </property>
        <property name="preferredIdpSLOBinding">
            <value>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact</value>
        </property>
        <property name="spBindingACS">
            <value>http://localhost:8081/IDBUS/IDA3/PROXY1-IDP/SSO/ACSPROXY/ARTIFACT</value>
        </property>
        <property name="spBindingSLO">
            <value>http://localhost:8081/IDBUS/IDA3/PROXY1-IDP/SSO/SLOPROXY/ARTIFACT</value>
        </property>
        <property name="logMessages">
            <value>true</value>
        </property>
        <property name="artifactQueueManager">
            <ref bean="ida3-aqm"/>
        </property>
        <property name="bindingFactory">
            <bean class="org.atricore.idbus.capabilities.sso.main.binding.SamlR2BindingFactory"/>
        </property>
        <property name="logger">
            <bean class="org.atricore.idbus.kernel.main.mediation.camel.logging.DefaultMediationLogger" name="proxy1-sp-mediation-logger">
                <property name="category">
                    <value>com.ida3.ida3.wire.proxy1-sp</value>
                </property>
                <property name="messageBuilders">
                    <list>
                        <bean class="org.atricore.idbus.capabilities.sso.main.binding.logging.SamlR2LogMessageBuilder"/>
                        <bean class="org.atricore.idbus.capabilities.sso.main.binding.logging.SSOLogMessageBuilder"/>
                        <bean class="org.atricore.idbus.kernel.main.mediation.camel.component.logging.CamelLogMessageBuilder"/>
                        <bean class="org.atricore.idbus.kernel.main.mediation.camel.component.logging.HttpLogMessageBuilder"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="errorUrl">
            <value>http://localhost:8081/idbus-ui/error.do</value>
        </property>
        <property name="warningUrl">
            <value>http://localhost:8081/idbus-ui/warn/policy-enforcement.do</value>
        </property>
        <property name="signer">
            <ref bean="proxy1-sp-samlr2-signer"/>
        </property>
        <property name="signRequests">
            <value>false</value>
        </property>
        <property name="validateRequestsSignature">
            <value>false</value>
        </property>
        <property name="encrypter">
            <ref bean="proxy1-sp-samlr2-encrypter"/>
        </property>
    </bean>
    <bean init-method="init" class="org.atricore.idbus.capabilities.sso.support.core.signature.JSR105SamlR2SignerImpl" name="proxy1-sp-samlr2-signer">
        <description/>
        <property name="keyResolver">
            <bean class="org.atricore.idbus.capabilities.sso.support.core.SSOKeystoreKeyResolver">
                <property name="keystoreType">
                    <value>JKS</value>
                </property>
                <property name="keystoreFile">
                    <value>classpath:com/ida3/idau/proxy1-sp/idp1-keystore.jks</value>
                </property>
                <property name="keystorePass">
                    <value>ATRICORE</value>
                </property>
                <property name="privateKeyAlias">
                    <value>josso-sp1</value>
                </property>
                <property name="privateKeyPass">
                    <value>ATRICORE</value>
                </property>
                <property name="certificateAlias">
                    <value>josso-sp1</value>
                </property>
            </bean>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.support.core.encryption.XmlSecurityEncrypterImpl" name="proxy1-sp-samlr2-encrypter">
        <property name="symmetricKeyAlgorithmURI">
            <value>http://www.w3.org/2001/04/xmlenc#aes128-cbc</value>
        </property>
        <property name="kekAlgorithmURI">
            <value>http://www.w3.org/2001/04/xmlenc#rsa-1_5</value>
        </property>
        <property name="keyResolver">
            <bean class="org.atricore.idbus.capabilities.sso.support.core.SSOKeystoreKeyResolver">
                <property name="keystoreType">
                    <value>JKS</value>
                </property>
                <property name="keystoreFile">
                    <value>classpath:com/ida3/idau/proxy1-sp/idp1-keystore.jks</value>
                </property>
                <property name="keystorePass">
                    <value>ATRICORE</value>
                </property>
                <property name="privateKeyAlias">
                    <value>josso-sp1</value>
                </property>
                <property name="privateKeyPass">
                    <value>ATRICORE</value>
                </property>
                <property name="certificateAlias">
                    <value>josso-sp1</value>
                </property>
            </bean>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.federation.AccountLinkLifecycleImpl" name="proxy1-sp-account-link-lifecycle"/>
    <bean class="org.atricore.idbus.capabilities.sso.management.internal.ServiceProviderMBeanImpl" name="proxy1-sp-mbean">
        <property name="serviceProvider">
            <ref bean="proxy1-sp"/>
        </property>
    </bean>
    <bean class="org.springframework.jmx.export.MBeanExporter" name="proxy1-sp-mbean-exporter">
        <property name="server">
            <ref bean="mBeanServer"/>
        </property>
        <property name="beans">
            <map>
                <entry value-ref="proxy1-sp-mbean" key-ref="proxy1-sp-mbean-key"/>
            </map>
        </property>
    </bean>
    <bean class="java.lang.String" name="proxy1-sp-mbean-key">
        <constructor-arg type="java.lang.String" index="0">
            <value>com.ida3.idau:type=ServiceProvider,name=ida3.proxy1-sp</value>
        </constructor-arg>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.session.service.SSOSessionManagerImpl" name="proxy1-sp-session-manager">
        <property name="maxInactiveInterval">
            <value>500</value>
        </property>
        <property name="maxSessionsPerUser">
            <value>-1</value>
        </property>
        <property name="invalidateExceedingSessions">
            <value>false</value>
        </property>
        <property name="sessionMonitorInterval">
            <value>10000</value>
        </property>
        <property name="sessionIdGenerator">
            <bean class="org.atricore.idbus.kernel.main.session.service.SessionIdGeneratorImpl">
                <property name="algorithm">
                    <value>MD5</value>
                </property>
            </bean>
        </property>
        <property name="sessionStore">
            <bean init-method="init" class="org.atricore.idbus.idojos.ehcachesessionstore.EHCacheSessionStore">
                <property name="cacheManager">
                    <ref bean="ida3-cache-manager"/>
                </property>
                <property name="cacheName">
                    <value>ida3-proxy1-sp-sessionsCache</value>
                </property>
            </bean>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.mediation.provider.FederationServiceImpl" name="proxy1-sp-sso-default-svc">
        <property name="serviceType">
            <value>urn:oasis:names:tc:SAML:2.0</value>
        </property>
        <property name="name">
            <value>proxy1-sp-sso-default-svc</value>
        </property>
        <property name="channel">
            <ref bean="proxy1-sp-default-idp-channel"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.federation.metadata.ResourceCircleOfTrustMemberDescriptorImpl" name="proxy1-sp-md">
        <property name="id">
            <value>+WtVS2fGicwmPTKuI0XuqYFwCG0=</value>
        </property>
        <property name="alias">
            <value>http://localhost:8081/IDBUS/IDA3/PROXY1-SP/SAML2/MD</value>
        </property>
        <property name="resource">
            <value>classpath:com/ida3/idau/proxy1-sp/proxy1-sp-samlr2-metadata.xml</value>
        </property>
        <property name="metadataIntrospector">
            <bean class="org.atricore.idbus.capabilities.sso.main.SamlR2MetadataDefinitionIntrospector"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.mediation.channel.IdPChannelImpl" name="proxy1-sp-default-idp-channel">
        <property name="name">
            <value>proxy1-sp-default-idp-channel</value>
        </property>
        <property name="description">
            <value>proxy1-sp</value>
        </property>
        <property name="proxy">
            <ref bean="proxy1-idp-sso-default-sp-channel"/>
        </property>
        <property name="proxyModeEnabled">
            <value>true</value>
        </property>
        <property name="location">
            <value>http://localhost:8081/IDBUS/IDA3/PROXY1-SP</value>
        </property>
        <property name="provider">
            <ref bean="proxy1-sp"/>
        </property>
        <property name="sessionManager">
            <ref bean="proxy1-sp-session-manager"/>
        </property>
        <property name="member">
            <ref bean="proxy1-sp-md"/>
        </property>
        <property name="identityMediator">
            <ref bean="proxy1-sp-samlr2-mediator"/>
        </property>
        <property name="accountLinkLifecycle">
            <ref bean="proxy1-sp-account-link-lifecycle"/>
        </property>
        <property name="accountLinkEmitter">
            <ref bean="proxy1-sp-account-link-emitter"/>
        </property>
        <property name="identityMapper">
            <ref bean="proxy1-sp-identity-mapper"/>
        </property>
        <property name="endpoints">
            <list>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="proxy1-sp-default-idp-channel-saml2-slo-http-post">
                    <property name="name">
                        <value>proxy1-sp-default-idp-channel-saml2-slo-http-post</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleLogoutService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="proxy1-sp-default-idp-channel-spsso-samlr2sloreq-to-samlr2resp-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="proxy1-sp-default-idp-channel-saml2-slo-soap">
                    <property name="name">
                        <value>proxy1-sp-default-idp-channel-saml2-slo-soap</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleLogoutService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:SOAP</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="proxy1-sp-default-idp-channel-spsso-samlr2sloreq-to-samlr2resp-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="proxy1-sp-default-idp-channel-saml2-slo-local">
                    <property name="name">
                        <value>proxy1-sp-default-idp-channel-saml2-slo-local</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleLogoutService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:LOCAL</value>
                    </property>
                    <property name="location">
                        <value>local://IDA3/PROXY1-SP/SAML2/SLO/LOCAL</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="proxy1-sp-default-idp-channel-spsso-samlr2sloreq-to-samlr2resp-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="proxy1-sp-default-idp-channel-saml2-ac-http-post">
                    <property name="name">
                        <value>proxy1-sp-default-idp-channel-saml2-ac-http-post</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}AssertionConsumerService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="proxy1-sp-default-idp-channel-idpunsolicitedresponse-to-subject-plan"/>
                            <ref bean="proxy1-sp-default-idp-channel-samlr2authnresp-to-ssospauthnresp-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="proxy1-sp-default-idp-channel-saml2-ar-soap">
                    <property name="name">
                        <value>proxy1-sp-default-idp-channel-saml2-ar-soap</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}ArtifactResolutionService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:SOAP</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="proxy1-sp-default-idp-channel-samlr2artresolve-to-samlr2artresponse-plan"/>
                            <ref bean="proxy1-sp-default-idp-channel-samlr2art-to-samlr2artresolve-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="proxy1-sp-default-idp-channel-saml2-ar-local">
                    <property name="name">
                        <value>proxy1-sp-default-idp-channel-saml2-ar-local</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}ArtifactResolutionService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:LOCAL</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="proxy1-sp-default-idp-channel-samlr2artresolve-to-samlr2artresponse-plan"/>
                            <ref bean="proxy1-sp-default-idp-channel-samlr2art-to-samlr2artresolve-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="proxy1-sp-default-idp-channel-sso-cc-local">
                    <property name="name">
                        <value>proxy1-sp-default-idp-channel-sso-cc-local</value>
                    </property>
                    <property name="type">
                        <value>{urn:org:atricore:idbus:sso:metadata}CredentialsCallbackService</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:LOCAL</value>
                    </property>
                    <property name="location">
                        <value>local://IDA3/PROXY1-SP/CCBACK/LOCAL</value>
                    </property>
                </bean>
            </list>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.support.federation.OneToOneAccountLinkEmitter" name="proxy1-sp-account-link-emitter"/>
    <bean class="org.atricore.idbus.capabilities.sso.support.federation.RemoteSubjectIdentityMapper" name="proxy1-sp-identity-mapper">
        <property name="useLocalId">
            <value>false</value>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.sp.plans.SamlR2SloRequestToSamlR2RespPlan" name="proxy1-sp-default-idp-channel-spsso-samlr2sloreq-to-samlr2resp-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.sp.plans.SPInitiatedAuthnReqToSamlR2AuthnReqPlan" name="proxy1-sp-default-idp-channel-idpunsolicitedresponse-to-subject-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.sp.plans.SamlR2AuthnResponseToSPAuthnResponse" name="proxy1-sp-default-idp-channel-samlr2authnresp-to-ssospauthnresp-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.binding.plans.SamlR2ArtifactResolveToSamlR2ArtifactResponsePlan" name="proxy1-sp-default-idp-channel-samlr2artresolve-to-samlr2artresponse-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.binding.plans.SamlR2ArtifactToSamlR2ArtifactResolvePlan" name="proxy1-sp-default-idp-channel-samlr2art-to-samlr2artresolve-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.mediation.binding.BindingChannelImpl" name="proxy1-sp-idp1">
        <property name="name">
            <value>proxy1-sp-idp1</value>
        </property>
        <property name="description">
            <value/>
        </property>
        <property name="unitContainer">
            <ref bean="ida3-container"/>
        </property>
        <property name="provider">
            <ref bean="proxy1-sp"/>
        </property>
        <property name="location">
            <value>http://localhost:8081/IDBUS/IDA3/PROXY1-SP/PROXY1-SP</value>
        </property>
        <property name="identityMediator">
            <ref bean="proxy1-sp-samlr2-mediator"/>
        </property>
        <property name="endpoints">
            <list>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="proxy1-sp-default-idp-channel-ssoproxy">
                    <property name="name">
                        <value>proxy1-sp-default-idp-channel-ssoproxy</value>
                    </property>
                    <property name="type">
                        <value>{urn:org:atricore:idbus:sso:metadata}SPInitiatedSingleSignOnServiceProxy</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:HTTP-Artifact</value>
                    </property>
                    <property name="location">
                        <value>/SSO/SSOPROXY/ARTIFACT</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="proxy1-sp-spinitiatedauthnreq-to-samlr2autnreq-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="proxy1-sp-sso-shb-soap">
                    <property name="name">
                        <value>proxy1-sp-sso-shb-soap</value>
                    </property>
                    <property name="type">
                        <value>{urn:org:atricore:idbus:sso:metadata}SPSessionHeartBeatService</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:SOAP</value>
                    </property>
                    <property name="location">
                        <value>/SSO/SSHB/SOAP</value>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="proxy1-sp-sso-shb-local">
                    <property name="name">
                        <value>proxy1-sp-sso-shb-local</value>
                    </property>
                    <property name="type">
                        <value>{urn:org:atricore:idbus:sso:metadata}SPSessionHeartBeatService</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:LOCAL</value>
                    </property>
                    <property name="location">
                        <value>local://IDA3/PROXY1-SP/SSO/SSHB/LOCAL</value>
                    </property>
                </bean>
            </list>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.sp.plans.SPInitiatedAuthnReqToSamlR2AuthnReqPlan" name="proxy1-sp-spinitiatedauthnreq-to-samlr2autnreq-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.sp.plans.SPInitiatedLogoutReqToSamlR2LogoutReqPlan" name="proxy1-sp-spinitiatedsloreq-to-samlr2sloreq-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.sp.plans.SPSessionHeartBeatReqToSamlR2AuthnReqPlan" name="proxy1-sp-spsessionheartbeatreq-to-samlr2autnreq-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
</beans>
