<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:ns2="http://www.springframework.org/schema/osgi" xmlns:ns3="http://www.springframework.org/schema/tool" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd http://www.springframework.org/schema/osgi http://www.springframework.org/schema/osgi/spring-osgi.xsd">
    <description>ida3 : IdAU Configuration generated by Atricore Console on 1 Feb 2012 18:41:23 GMT</description>
    <bean depends-on="ida3-cot,ida3-cot-manager,bpms-manager,cxf" class="org.atricore.idbus.kernel.main.mediation.osgi.OsgiIdentityMediationUnit" name="ida3-mediation-unit">
        <property name="name">
            <value>ida3-mediation-unit</value>
        </property>
        <property name="container">
            <ref bean="ida3-container"/>
        </property>
        <property name="channels">
            <list>
                <ref bean="sp1-oauth2-resource"/>
                <ref bean="sp1-default-idp-channel"/>
                <ref bean="proxy1-idp-claims-channel"/>
                <ref bean="proxy1-idp-sso-default-sp-channel"/>
                <ref bean="proxy1-idp-oauth2-default-sp-channel"/>
                <ref bean="proxy1-sp-idp1"/>
                <ref bean="proxy1-sp-default-idp-channel"/>
                <ref bean="oauth2-josso-binding-channel"/>
            </list>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.mediation.camel.OsgiCamelIdentityMediationUnitContainerImpl" name="ida3-container">
        <property name="name">
            <value>ida3-engine</value>
        </property>
        <property name="cxfBus">
            <ref bean="cxf"/>
        </property>
    </bean>
    <bean depends-on="sp1,proxy1-idp,idp1,proxy1-sp" class="org.atricore.idbus.kernel.main.federation.metadata.CircleOfTrustImpl" name="ida3-cot">
        <property name="name">
            <value>ida3-cot</value>
        </property>
        <property name="providers">
            <set>
                <ref bean="sp1"/>
                <ref bean="proxy1-idp"/>
                <ref bean="idp1"/>
                <ref bean="proxy1-sp"/>
                <ref bean="oauth2"/>
            </set>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.federation.metadata.CircleOfTrustManagerImpl" name="ida3-cot-manager">
        <property name="cot">
            <ref bean="ida3-cot"/>
        </property>
    </bean>
    <bean factory-method="getInstance" class="org.atricore.idbus.kernel.main.session.SSOSessionEventManager" name="session-event-manager">
        <property name="listeners">
            <list>
                <bean class="org.atricore.idbus.capabilities.sso.main.idp.IdPSessionEventListener">
                    <property name="identityProvider">
                        <ref bean="proxy1-idp"/>
                    </property>
                </bean>
            </list>
        </property>
    </bean>
    <bean factory-bean="cache-manager-factory" factory-method="getCacheManager" class="net.sf.ehcache.CacheManager" name="ida3-cache-manager"/>
    <bean class="org.atricore.idbus.kernel.main.mediation.state.EHCacheProviderStateManagerImpl" name="ida3-state-manager">
        <constructor-arg index="0">
            <ref bean="idbus-config"/>
        </constructor-arg>
        <property name="cacheManager">
            <ref bean="ida3-cache-manager"/>
        </property>
        <property name="cacheName">
            <value>com.ida3.ida3.idau-psm-cache</value>
        </property>
        <property name="forceNonDirtyStorage">
            <value>false</value>
        </property>
    </bean>
    <bean scope="singleton" class="org.springframework.jmx.support.MBeanServerFactoryBean" name="mBeanServer">
        <property name="locateExistingServerIfPossible">
            <value>true</value>
        </property>
    </bean>
    <bean scope="singleton" class="org.atricore.idbus.kernel.planning.IdentityPlanRegistryImpl" name="identity-plans-registry"/>
    <import resource="sp1/sp1-config.xml"/>
    <import resource="proxy1-idp/proxy1-idp-config.xml"/>
    <import resource="idp1/idp1-config.xml"/>
    <import resource="proxy1-sp/proxy1-sp-config.xml"/>
    <import resource="oauth2/oauth2-config.xml"/>
</beans>
