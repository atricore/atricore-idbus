<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:ns2="http://www.springframework.org/schema/osgi" xmlns:ns3="http://www.springframework.org/schema/tool" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd http://www.springframework.org/schema/osgi http://www.springframework.org/schema/osgi/spring-osgi.xsd">
    <description>IDP1 : IdP Configuration generated by Atricore Identity Bus Server on 14 May 2011 20:24:05 GMT</description>
    <bean class="org.atricore.idbus.kernel.main.mediation.provider.IdentityProviderImpl" name="idp1">
        <property name="name">
            <value>idp1</value>
        </property>
        <property name="description">
            <value>IDP1</value>
        </property>
        <property name="role">
            <value>{urn:oasis:names:tc:SAML:2.0:metadata}IDPSSODescriptor</value>
        </property>
        <property name="unitContainer">
            <ref bean="simple-iwa-container"/>
        </property>
        <property name="cotManager">
            <ref bean="simple-iwa-cot-manager"/>
        </property>
        <property name="stateManager">
            <ref bean="simple-iwa-state-manager"/>
        </property>
        <property name="channel">
            <ref bean="idp1-default-sp-channel"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.idp.SSOIDPMediator" name="idp1-samlr2-a2Mediator">
        <property name="logMessages">
            <value>true</value>
        </property>
        <property name="artifactQueueManager">
            <ref bean="simple-iwa-aqm"/>
        </property>
        <property name="bindingFactory">
            <bean class="org.atricore.idbus.capabilities.sso.main.binding.SamlR2BindingFactory"/>
        </property>
        <property name="logger">
            <bean class="org.atricore.idbus.kernel.main.mediation.camel.logging.XMLMediationLogger" name="idp1-mediation-logger">
                <property name="category">
                    <value>org.atricore.idbus.examples.simple-iwa.wire.idp1</value>
                </property>
                <property name="messageBuilders">
                    <list>
                        <bean class="org.atricore.idbus.capabilities.sso.main.binding.logging.SamlR2LogMessageBuilder"/>
                        <bean class="org.atricore.idbus.capabilities.sso.main.binding.logging.SSOLogMessageBuilder"/>
                        <bean class="org.atricore.idbus.kernel.main.mediation.camel.component.logging.CamelLogMessageBuilder"/>
                        <bean class="org.atricore.idbus.kernel.main.mediation.camel.component.logging.HttpLogMessageBuilder"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="errorUrl">
            <value>http://wsdev1.w2k3dev.atricore.com:8081/idbus-ui/error.do</value>
        </property>
        <property name="signRequests">
            <value>true</value>
        </property>
        <property name="validateRequestsSignature">
            <value>true</value>
        </property>
        <property name="signer">
            <ref bean="idp1-samlr2-signer"/>
        </property>
        <property name="encrypter">
            <ref bean="idp1-samlr2-encrypter"/>
        </property>
    </bean>
    <bean init-method="init" class="org.atricore.idbus.capabilities.sso.support.core.signature.JSR105SamlR2SignerImpl" name="idp1-samlr2-signer">
        <description/>
        <property name="keyResolver">
            <bean class="org.atricore.idbus.capabilities.sso.support.core.SSOKeystoreKeyResolver">
                <property name="keystoreType">
                    <value>JKS</value>
                </property>
                <property name="keystoreFile">
                    <value>classpath:org/atricore/idbus/examples/idau/idp1/idp1-keystore.jks</value>
                </property>
                <property name="keystorePass">
                    <value>ATRICORE</value>
                </property>
                <property name="privateKeyAlias">
                    <value>josso-sp1</value>
                </property>
                <property name="privateKeyPass">
                    <value>ATRICORE</value>
                </property>
                <property name="certificateAlias">
                    <value>josso-sp1</value>
                </property>
            </bean>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.support.core.encryption.XmlSecurityEncrypterImpl" name="idp1-samlr2-encrypter">
        <property name="symmetricKeyAlgorithmURI">
            <value>http://www.w3.org/2001/04/xmlenc#aes128-cbc</value>
        </property>
        <property name="kekAlgorithmURI">
            <value>http://www.w3.org/2001/04/xmlenc#rsa-1_5</value>
        </property>
        <property name="keyResolver">
            <bean class="org.atricore.idbus.capabilities.sso.support.core.SSOKeystoreKeyResolver">
                <property name="keystoreType">
                    <value>JKS</value>
                </property>
                <property name="keystoreFile">
                    <value>classpath:org/atricore/idbus/examples/idau/idp1/idp1-keystore.jks</value>
                </property>
                <property name="keystorePass">
                    <value>ATRICORE</value>
                </property>
                <property name="privateKeyAlias">
                    <value>josso-sp1</value>
                </property>
                <property name="privateKeyPass">
                    <value>ATRICORE</value>
                </property>
                <property name="certificateAlias">
                    <value>josso-sp1</value>
                </property>
            </bean>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.management.internal.IdentityProviderMBeanImpl" name="idp1-mbean">
        <property name="identityProvider">
            <ref bean="idp1"/>
        </property>
    </bean>
    <bean class="org.springframework.jmx.export.MBeanExporter" name="idp1-mbean-exporter">
        <property name="server">
            <ref bean="mBeanServer"/>
        </property>
        <property name="beans">
            <map>
                <entry value-ref="idp1-mbean" key-ref="idp1-mbean-key"/>
            </map>
        </property>
    </bean>
    <bean class="java.lang.String" name="idp1-mbean-key">
        <constructor-arg type="java.lang.String" index="0">
            <value>org.atricore.idbus.examples.idau:type=IdentityProvider,name=simple-iwa.idp1</value>
        </constructor-arg>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.idp.plans.SamlR2SloRequestToSamlR2RespPlan" name="idp1-samlr2sloreq-to-samlr2resp-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.idp.plans.SamlR2SloRequestToSpSamlR2SloRequestPlan" name="idp1-samlr2sloreq-to-samlr2spsloreq-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.idp.plans.SamlR2AuthnRequestToSamlR2ResponsePlan" name="idp1-samlr2authnreq-to-samlr2resp-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.emitter.plans.SamlR2SecurityTokenToAuthnAssertionPlan" name="idp1-samlr2authnstmt-to-samlr2assertion-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
        <property name="identityManagers">
            <ref bean="idp1-identity-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.binding.plans.SamlR2ArtifactResolveToSamlR2ArtifactResponsePlan" name="idp1-samlr2artresolve-to-samlr2artresponse-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.binding.plans.SamlR2ArtifactToSamlR2ArtifactResolvePlan" name="idp1-samlr2art-to-samlr2artresolve-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.idp.plans.IDPInitiatedAuthnReqToSamlR2AuthnReqPlan" name="idp1-samlr2idpinitiatedauthnreq-to-samlr2authnreq-plan">
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.session.service.SSOSessionManagerImpl" name="idp1-session-manager">
        <property name="maxInactiveInterval">
            <value>30</value>
        </property>
        <property name="maxSessionsPerUser">
            <value>-1</value>
        </property>
        <property name="invalidateExceedingSessions">
            <value>false</value>
        </property>
        <property name="sessionMonitorInterval">
            <value>10000</value>
        </property>
        <property name="sessionIdGenerator">
            <bean class="org.atricore.idbus.kernel.main.session.service.SessionIdGeneratorImpl">
                <property name="algorithm">
                    <value>MD5</value>
                </property>
            </bean>
        </property>
        <property name="sessionStore">
            <bean init-method="init" class="org.atricore.idbus.idojos.ehcachesessionstore.EHCacheSessionStore">
                <property name="cacheManager">
                    <ref bean="simple-iwa-cache-manager"/>
                </property>
                <property name="cacheName">
                    <value>simple-iwa-idp1-sessionsCache</value>
                </property>
            </bean>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.federation.metadata.ResourceCircleOfTrustMemberDescriptorImpl" name="idp1-md">
        <property name="id">
            <value>ukVDlD1IKruDE3MHNtTKyUuXKjk=</value>
        </property>
        <property name="alias">
            <value>http://wsdev1.w2k3dev.atricore.com:8081/IDBUS/SIMPLE-IWA/IDP1/SAML2/MD</value>
        </property>
        <property name="resource">
            <value>classpath:org/atricore/idbus/examples/idau/idp1/idp1-samlr2-metadata.xml</value>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.mediation.channel.SPChannelImpl" name="idp1-default-sp-channel">
        <property name="name">
            <value>idp1-default-sp-channel</value>
        </property>
        <property name="description">
            <value>IDP1</value>
        </property>
        <property name="location">
            <value>http://wsdev1.w2k3dev.atricore.com:8081/IDBUS/SIMPLE-IWA/IDP1</value>
        </property>
        <property name="provider">
            <ref bean="idp1"/>
        </property>
        <property name="sessionManager">
            <ref bean="idp1-session-manager"/>
        </property>
        <property name="identityManager">
            <ref bean="idp1-identity-manager"/>
        </property>
        <property name="member">
            <ref bean="idp1-md"/>
        </property>
        <property name="identityMediator">
            <ref bean="idp1-samlr2-a2Mediator"/>
        </property>
        <property name="endpoints">
            <list>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-saml2-slo-http-post">
                    <property name="name">
                        <value>idp1-default-sp-channel-saml2-slo-http-post</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleLogoutService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2sloreq-to-samlr2resp-plan"/>
                            <ref bean="idp1-samlr2sloreq-to-samlr2spsloreq-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-saml2-slo-http-artifact">
                    <property name="name">
                        <value>idp1-default-sp-channel-saml2-slo-http-artifact</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleLogoutService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2sloreq-to-samlr2resp-plan"/>
                            <ref bean="idp1-samlr2sloreq-to-samlr2spsloreq-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-saml2-slo-soap">
                    <property name="name">
                        <value>idp1-default-sp-channel-saml2-slo-soap</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleLogoutService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:SOAP</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2sloreq-to-samlr2resp-plan"/>
                            <ref bean="idp1-samlr2sloreq-to-samlr2spsloreq-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-saml2-slo-local">
                    <property name="name">
                        <value>idp1-default-sp-channel-saml2-slo-local</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleLogoutService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:LOCAL</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2sloreq-to-samlr2resp-plan"/>
                            <ref bean="idp1-samlr2sloreq-to-samlr2spsloreq-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-saml2-sso-http-post">
                    <property name="name">
                        <value>idp1-default-sp-channel-saml2-sso-http-post</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleSignOnService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2authnreq-to-samlr2resp-plan"/>
                            <ref bean="idp1-samlr2authnstmt-to-samlr2assertion-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-saml2-sso-http-artifact">
                    <property name="name">
                        <value>idp1-default-sp-channel-saml2-sso-http-artifact</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleSignOnService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2authnreq-to-samlr2resp-plan"/>
                            <ref bean="idp1-samlr2authnstmt-to-samlr2assertion-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-saml2-ar-soap">
                    <property name="name">
                        <value>idp1-default-sp-channel-saml2-ar-soap</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}ArtifactResolutionService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:SOAP</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2artresolve-to-samlr2artresponse-plan"/>
                            <ref bean="idp1-samlr2art-to-samlr2artresolve-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-saml2-ar-local">
                    <property name="name">
                        <value>idp1-default-sp-channel-saml2-ar-local</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}ArtifactResolutionService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:2.0:bindings:LOCAL</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2artresolve-to-samlr2artresponse-plan"/>
                            <ref bean="idp1-samlr2art-to-samlr2artresolve-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-saml11-ar-soap">
                    <property name="name">
                        <value>idp1-default-sp-channel-saml11-ar-soap</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}ArtifactResolutionService</value>
                    </property>
                    <property name="binding">
                        <value>urn:oasis:names:tc:SAML:1.1:bindings:SOAP</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2artresolve-to-samlr2artresponse-plan"/>
                            <ref bean="idp1-samlr2art-to-samlr2artresolve-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-idp-initiated-saml2">
                    <property name="name">
                        <value>idp1-default-sp-channel-idp-initiated-saml2</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleSignOnService</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:SAML:1:1:IDP-Initiated-SSO-http</value>
                    </property>
                    <property name="location">
                        <value>/SAML11/SSO/IDP_INITIATE</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2idpinitiatedauthnreq-to-samlr2authnreq-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-idp-initiated-saml11">
                    <property name="name">
                        <value>idp1-default-sp-channel-idp-initiated-saml11</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleSignOnService</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:SAML:2:0:IDP-Initiated-SSO-http</value>
                    </property>
                    <property name="location">
                            <value>/SAML2/SSO/IDP_INITIATE</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2idpinitiatedauthnreq-to-samlr2authnreq-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-sso-shb-soap">
                    <property name="name">
                        <value>idp1-default-sp-channel-sso-shb-soap</value>
                    </property>
                    <property name="type">
                        <value>{urn:org:atricore:idbus:sso:metadata}IDPSessionHeartBeatService</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:SOAP</value>
                    </property>
                    <property name="location">
                        <value>/SSO/SSHB/SOAP</value>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-sso-shb-local">
                    <property name="name">
                        <value>idp1-default-sp-channel-sso-shb-local</value>
                    </property>
                    <property name="type">
                        <value>{urn:org:atricore:idbus:sso:metadata}IDPSessionHeartBeatService</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:LOCAL</value>
                    </property>
                    <property name="location">
                        <value>local://SIMPLE-IWA/IDP1/SSO/SSHB/LOCAL</value>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-sso-sso-http-artifact">
                    <property name="name">
                        <value>idp1-default-sp-channel-sso-sso-http-artifact</value>
                    </property>
                    <property name="type">
                        <value>{urn:oasis:names:tc:SAML:2.0:metadata}SingleSignOnService</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:HTTP-Artifact</value>
                    </property>
                    <property name="location">
                        <value>/SSO/SSO/ARTIFACT</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2authnreq-to-samlr2resp-plan"/>
                            <ref bean="idp1-samlr2authnstmt-to-samlr2assertion-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-sso-slo-soap">
                    <property name="name">
                        <value>idp1-default-sp-channel-sso-slo-soap</value>
                    </property>
                    <property name="type">
                        <value>{urn:org:atricore:idbus:sso:metadata}IDPInitiatedSingleLogoutService</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:SOAP</value>
                    </property>
                    <property name="location">
                        <value>/SSO/SLO/SOAP</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2sloreq-to-samlr2spsloreq-plan"/>
                        </list>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-default-sp-channel-sso-slo-local">
                    <property name="name">
                        <value>idp1-default-sp-channel-sso-slo-local</value>
                    </property>
                    <property name="type">
                        <value>{urn:org:atricore:idbus:sso:metadata}IDPInitiatedSingleLogoutService</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:LOCAL</value>
                    </property>
                    <property name="location">
                        <value>local://SIMPLE-IWA/IDP1/IDP1/SSO/SLO/LOCAL</value>
                    </property>
                    <property name="identityPlans">
                        <list>
                            <ref bean="idp1-samlr2sloreq-to-samlr2spsloreq-plan"/>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
        <property name="claimProviders">
            <!--
            <ref bean="idp1-claims-channel"/>
            -->
            <!-- TODO: An SP channel should have 1-M claim channels, where more than one could be selected for collecting
             credentials claims
             -->
            <ref bean="idp1-spnego-claims-channel"/>
        </property>
        <property name="securityTokenService">
            <ref bean="idp1-sts"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.mediation.claim.ClaimChannelImpl" name="idp1-claims-channel">
        <property name="name">
            <value>idp1-claims-channel</value>
        </property>
        <property name="location">
            <value>http://wsdev1.w2k3dev.atricore.com:8081/IDBUS/SIMPLE-IWA/IDP1/CC</value>
        </property>
        <property name="endpoints">
            <list>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-cc-pwd-artifact">
                    <property name="name">
                        <value>idp1-cc-pwd-artifact</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:HTTP-Artifact</value>
                    </property>
                    <property name="location">
                        <value>/PWD/ARTIFACT</value>
                    </property>
                    <property name="responseLocation">
                        <value>/PWD/POST-RESP</value>
                    </property>
                    <property name="type">
                        <value>urn:oasis:names:tc:SAML:2.0:ac:classes:Password</value>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-cc-pwd-post">
                    <property name="name">
                        <value>idp1-cc-pwd-post</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:HTTP-POST</value>
                    </property>
                    <property name="location">
                        <value>/PWD/POST</value>
                    </property>
                    <property name="type">
                        <value>urn:oasis:names:tc:SAML:2.0:ac:classes:Password</value>
                    </property>
                </bean>
            </list>
        </property>
        <property name="identityMediator">
            <ref bean="idp1-samlr2-claims-a2Mediator"/>
        </property>
        <property name="provider">
            <ref bean="idp1"/>
        </property>
        <property name="unitContainer">
            <ref bean="simple-iwa-container"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.claims.SSOClaimsMediator" name="idp1-samlr2-claims-a2Mediator">
        <property name="logMessages">
            <value>true</value>
        </property>
        <property name="basicAuthnUILocation">
            <value>http://wsdev1.w2k3dev.atricore.com:8081/idbus-ui/claims/username-password.do</value>
        </property>
        <property name="twoFactorAuthnUILocation">
            <value>http://wsdev1.w2k3dev.atricore.com:8081/idbus-ui/claims/username-passcode.do</value>
        </property>
        <property name="artifactQueueManager">
            <ref bean="simple-iwa-aqm"/>
        </property>
        <property name="bindingFactory">
            <bean class="org.atricore.idbus.capabilities.sso.main.binding.SamlR2BindingFactory"/>
        </property>
        <property name="logger">
            <bean class="org.atricore.idbus.kernel.main.mediation.camel.logging.XMLMediationLogger" name="idp1-cc-mediation-logger">
                <property name="category">
                    <value>org.atricore.idbus.examples.simple-iwa.wire.cc1</value>
                </property>
                <property name="messageBuilders">
                    <list>
                        <bean class="org.atricore.idbus.capabilities.sso.main.binding.logging.SamlR2LogMessageBuilder"/>
                        <bean class="org.atricore.idbus.kernel.main.mediation.camel.component.logging.CamelLogMessageBuilder"/>
                        <bean class="org.atricore.idbus.kernel.main.mediation.camel.component.logging.HttpLogMessageBuilder"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="errorUrl">
            <value>http://wsdev1.w2k3dev.atricore.com:8081/idbus-ui/error.do</value>
        </property>
    </bean>
    <!-- Claim Channel for negotiating Service Token through SPNEGO/HTTP -->
    <bean class="org.atricore.idbus.kernel.main.mediation.claim.ClaimChannelImpl" name="idp1-spnego-claims-channel">
        <property name="name">
            <value>idp1-spnego-claims-channel</value>
        </property>
        <property name="location">
            <value>http://wsdev1.w2k3dev.atricore.com:8081/IDBUS/SIMPLE-IWA/IDP1/SPNEGO</value>
        </property>
        <property name="endpoints">
            <list>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-cc-pwd-artifact">
                    <property name="name">
                        <value>idp1-spnego-http-artifact</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:sso:bindings:HTTP-Artifact</value>
                    </property>
                    <property name="location">
                        <value>/HTTP/ARTIFACT</value>
                    </property>
                    <property name="type">
                        <value>urn:oasis:names:tc:SAML:2.0:ac:classes:Kerberos</value>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-spnego-http-initiator">
                    <property name="name">
                        <value>idp1-spnego-http-initiator</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:spnego:bindings:HTTP-INITIATION</value>
                    </property>
                    <property name="location">
                        <value>/HTTP/INITIATE</value>
                    </property>
                </bean>
                <bean class="org.atricore.idbus.kernel.main.mediation.endpoint.IdentityMediationEndpointImpl" name="idp1-spnego-http-negotiator">
                    <property name="name">
                        <value>idp1-spnego-http-negotiator</value>
                    </property>
                    <property name="binding">
                        <value>urn:org:atricore:idbus:spnego:bindings:HTTP-NEGOTIATION</value>
                    </property>
                    <property name="location">
                        <value>/HTTP/NEGOTIATE</value>
                    </property>
                    <property name="type">
                        <value>urn:oasis:names:tc:SAML:2.0:ac:classes:Kerberos</value>
                    </property>
                </bean>
            </list>
        </property>
        <property name="identityMediator">
            <ref bean="idp1-spnego-claims-a2Mediator"/>
        </property>
        <property name="provider">
            <ref bean="idp1"/>
        </property>
        <property name="unitContainer">
            <ref bean="simple-iwa-container"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.spnego.SpnegoMediator" name="idp1-spnego-claims-a2Mediator">
        <property name="realm" value="spnego"/>
        <property name="principal" value="HTTP/wsdev1.w2k3dev.atricore.com@W2K3DEV.ATRICORE.COM"/>
        <property name="bindingFactory">
            <bean class="org.atricore.idbus.capabilities.spnego.SpnegoBindingFactory"/>
        </property>
        <property name="logMessages">
            <value>true</value>
        </property>
        <property name="artifactQueueManager">
            <ref bean="simple-iwa-aqm"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.mediation.camel.logging.XMLMediationLogger" name="idp1-cc-mediation-logger">
        <property name="category">
            <value>org.atricore.idbus.examples.simple-iwa.wire.cc1</value>
        </property>
        <property name="messageBuilders">
            <list>
                <bean class="org.atricore.idbus.capabilities.sso.main.binding.logging.SamlR2LogMessageBuilder"/>
                <bean class="org.atricore.idbus.kernel.main.mediation.camel.component.logging.CamelLogMessageBuilder"/>
                <bean class="org.atricore.idbus.kernel.main.mediation.camel.component.logging.HttpLogMessageBuilder"/>
            </list>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sts.main.WSTSecurityTokenService" name="idp1-sts">
        <property name="emitters">
            <list>
                <bean class="org.atricore.idbus.capabilities.sso.main.emitter.SamlR2SecurityTokenEmitter" name="idp1-samlr2-assertion-emitter">
                    <property name="id">
                        <value>idp1-samlr2-assertion-emitter</value>
                    </property>
                    <property name="identityPlan">
                        <ref bean="idp1-samlr2-sectoken-to-authnassertion-plan"/>
                    </property>
                    <property name="signer">
                        <ref bean="idp1-samlr2-signer"/>
                    </property>
                </bean>
            </list>
        </property>
        <property name="authenticators">
            <list>
                <bean class="org.atricore.idbus.capabilities.sts.main.DefaultSecurityTokenAuthenticator">
                    <property name="authenticator">
                        <ref bean="authenticator"/>
                    </property>
                </bean>
            </list>
        </property>
        <property name="artifactQueueManager">
            <ref bean="simple-iwa-aqm"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.emitter.SamlR2SecurityTokenEmitter" name="idp1-samlr2-assertion-emitter">
        <property name="id">
            <value>idp1-samlr2-assertion-emitter</value>
        </property>
        <property name="identityPlan">
            <ref bean="idp1-samlr2-sectoken-to-authnassertion-plan"/>
        </property>
        <property name="signer">
            <ref bean="idp1-samlr2-signer"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.sso.main.emitter.plans.SamlR2SecurityTokenToAuthnAssertionPlan" name="idp1-samlr2-sectoken-to-authnassertion-plan">
        <property name="identityManagers">
            <ref bean="idp1-identity-manager"/>
        </property>
        <property name="bpmsManager">
            <ref bean="bpms-manager"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.kernel.main.authn.AuthenticatorImpl" name="authenticator">
        <property name="authenticationSchemes">
            <list>
                <ref bean="idp1-basic-authn"/>
                <ref bean="idp1-spnego-authn"/>
            </list>
        </property>
    </bean>

    <bean class="org.atricore.idbus.kernel.main.authn.scheme.UsernamePasswordAuthScheme" name="idp1-basic-authn">
        <property name="name">
            <value>basic-authentication</value>
        </property>
        <property name="hashAlgorithm">
            <value>MD5</value>
        </property>
        <property name="hashEncoding">
            <value>HEX</value>
        </property>
        <property name="ignorePasswordCase">
            <value>false</value>
        </property>
        <property name="ignoreUserCase">
            <value>false</value>
        </property>
        <property name="credentialStore">
            <ref bean="idp1-identity-store"/>
        </property>
        <property name="credentialStoreKeyAdapter">
            <bean class="org.atricore.idbus.kernel.main.store.identity.SimpleIdentityStoreKeyAdapter"/>
        </property>
    </bean>
    <bean class="org.atricore.idbus.capabilities.spnego.SpnegoAuthenticationScheme" name="idp1-spnego-authn">
        <property name="name">
            <value>spnego-authentication</value>
        </property>
        <property name="realm">
            <value>spnego</value>
        </property>
        <property name="principalName">
            <value>HTTP/wsdev1.w2k3dev.atricore.com@W2K3DEV.ATRICORE.COM</value>
        </property>
    </bean>

    <bean class="org.atricore.idbus.kernel.main.store.SSOIdentityManagerImpl" name="idp1-identity-manager">
        <property name="identityStore">
            <ref bean="idp1-identity-store"/>
        </property>
        <property name="identityStoreKeyAdapter">
            <bean class="org.atricore.idbus.kernel.main.store.identity.SimpleIdentityStoreKeyAdapter"/>
        </property>
    </bean>

    <!-- ================================================================== -->
    <!-- Memory Identity Store with non-bind authentication                 -->
    <!-- ================================================================== -->
    <bean name="idp1-identity-store"
            class="org.atricore.idbus.idojos.memoryidentitystore.MemoryIdentityStore">
        <property name="usersFileName" value="classpath:org/atricore/idbus/examples/idau/idp1/atricore-users.xml"/>
        <property name="credentialsFileName" value="classpath:org/atricore/idbus/examples/idau/idp1/atricore-credentials.xml"/>
    </bean>
</beans>

